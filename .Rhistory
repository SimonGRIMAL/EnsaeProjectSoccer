library(RSQLite)
drv <- SQLite()
db <- dbConnect(drv, dbname="database.sqlite")
dbListTables(db)
#creation des dataframes
country <- dbGetQuery( db,'select * from Country' )
league <- dbGetQuery( db,'select * from League' )
match <- dbGetQuery( db,'select * from Match' )
player <- dbGetQuery( db,'select * from Player' )
player_attributes <- dbGetQuery( db,'select * from Player_Attributes' )
team <- dbGetQuery( db,'select * from Team' )
team_attributes <- dbGetQuery( db,'select * from Team_Attributes' )
sqlite_sequence<- dbGetQuery( db,'select * from sqlite_sequence' )
drv <- SQLite()
db <- dbConnect(drv, dbname="database.sqlite")
dbListTables(db)
setwd("C:/Users/admin/Desktop/Certificat Datascientist/PROJET")
load("match .RData")
load("match .RData")
match_hna_3 <- match_hna[complete.cases(match_hna[,c(12:77)]),]
match_hna_3 <- match_hna[complete.cases(match[,c(12:77)]),]
match_hna_3 <- match[complete.cases(match[,c(12:77)]),]
table(match_hna3$league_id)
table(match_hna_3$league_id)
table(match_hna_3$season)
load("league.RData")
View(league)
View(league)
load("team.RData")
load("team_attributes.RData")
View(team_attributes)
View(team_attributes)
summary(team_attributes)
# pas de NA
setwd("C:/Users/admin/Desktop/Certificat Datascientist/PROJET/EnsaeProjectSoccer")
library(RSQLite)
filename <- "database.sqlite"
sqlite.driver <- dbDriver("SQLite")
db <- dbConnect(sqlite.driver, dbname = filename)
dbListTables(db)
Match <- dbReadTable(db,"Match")
Team <- dbReadTable(db,"Team")
Team_Attributes <- dbReadTable(db,"Team_Attributes")
shiny::runApp('SoccerApp')
runApp('SoccerApp')
install.packages("shinydashboard")
runApp('SoccerApp')
install.packages("useshinyjs")
install.packages("useShinyjs")
runApp('SoccerApp')
runApp('SoccerApp')
install.packages("shinyjs")
runApp('SoccerApp')
install.packages("useShinyjs")
runApp('SoccerApp')
summary(Match$season)
table(Match$season)
View(Match)
View(Match)
table(Match$league_id)
League <- dbReadTable(db,"League")
View(League)
View(League)
Match_viz=filter(Match, season=='2015/2016' & league_id != 15722)
table(Match$season)
Match_viz=filter(Match, season=="2015/2016" & league_id != 15722)
library(dplyr)
Match_viz=filter(Match, season=="2015/2016" & league_id != 15722)
table(Match_viz$season)
table(Match_viz$league_id)
count(Match_viz,home_team_api_id)
length(unique(Match_viz$home_team_api_id))
length(unique(Match_viz$away_team_api_id))
nb_match_home<-count(Match_viz,home_team_api_id)
table(nb_match_home$n)
summarise(Match_viz,home_team_api_id)
Match_viz %>% group_by(home_team_api_id) %>%count(away_team_api_id)
nb_match_home_away<- Match_viz %>% group_by(home_team_api_id) %>%count(away_team_api_id)
table(nb_match_home_away$n)
filter(nb_match_home_away,n=2)
filter(nb_match_home_away,n==2)
test<-filter(Match_viz, home_team_api_id=7896  & away_team_api_id= 9956)
test<-filter(Match_viz, home_team_api_id==7896  & away_team_api_id==9956)
View(test)
View(test)
View(League)
View(League)
test2<-filter(Match_viz, (home_team_api_id==7896  & away_team_api_id==9956) | (home_team_api_id==9956  & away_team_api_id==7896))
View(test2)
View(test2)
Match %>% group_by(home_team_api_id,season) %>% count()
mb_match_team_season<- Match %>% group_by(home_team_api_id,season) %>% count()
View(mb_match_team_season)
nb_match_team_season<- Match %>% group_by(home_team_api_id,season) %>% count()
View(nb_match_team_season)
View(nb_match_team_season)
test<-filter(Match, home_team_api_id==1773)
View(test)
View(test)
test<-filter(Match, home_team_api_id==1957)
View(test)
View(test)
View(test)
View(test)
View(nb_match_team_season)
View(nb_match_team_season)
test2<-reshape(nb_match_team_season,timevar ="seeason",idvar = "home_team_api_id" )
test2<-reshape(nb_match_team_season,timevar ="seeason",idvar = "home_team_api_id",direction=direction = "wide")
test2<-reshape(nb_match_team_season,timevar ="season",idvar = "home_team_api_id",direction = "wide")
View(test2)
View(test2)
View(test)
View(test)
test2<-reshape(nb_match_team_season,v.names ="season",idvar = "home_team_api_id",direction = "wide")
test2<-reshape(nb_match_team_season,varying ="season",idvar = "home_team_api_id",direction = "wide")
View(nb_match_team_season)
View(nb_match_team_season)
View(test2)
View(test2)
library(reshape)
library(reshape2)
test2<-reshape(nb_match_team_season,timevar="season",idvar = "home_team_api_id",direction = "wide")
View(test2)
View(test2)
library(reshape2)
library(reshape)
install.packages(reshape)
install.packages("reshape")
library(reshape)
install.packages("reshape2")
test2<-cast(nb_match_team_season,home_team_api_id~season)
library(reshape)
test2<-cast(nb_match_team_season,home_team_api_id~season)
View(test2)
View(test2)
test2<-cast(nb_match_team_season,home_team_api_id~season,fill=0)
View(nb_match_team_season)
View(nb_match_team_season)
View(test2)
View(test2)
Team_home_viz<-cast(nb_match_team_season,home_team_api_id~season,fill=0)
rownames(Team_home_viz)
View(Team_home_viz)
View(Team_home_viz)
colnames(Team_home_viz)
colnames(Team_home_viz, do.NULL = TRUE, prefix = "season_")
View(Team_home_viz)
View(Team_home_viz)
colnames(Team_home_viz)<-colnames(Team_home_viz, do.NULL = TRUE, prefix = "season_")
colnames(Team_home_viz)<-colnames(Team_home_viz, do.NULL = FALSE, prefix = "nb_match_")
View(Team_home_viz)
colnames(Team_home_viz)
colnames(Team_home_viz)<-paste("nb_match", colnames(Team_home_viz), sep = "_")
colnames(Team_home_viz)[2:9]
Team_home_viz<-cast(nb_match_team_season,home_team_api_id~season,fill=0)
colnames(Team_home_viz)[2:9]<-paste("nb_match", colnames(Team_home_viz[2:9]), sep = "_")
Match$goal_diff <- home_team_goal-away_team_goal
Match$goal_diff <- Match$home_team_goal-Match$away_team_goal
View(Match)
View(Match)
Match$goal_diff_class <- cut(Match$goal_diff, breaks=c(min(Match$goal_diff),-1e-10,+1e-10,max(Match$goal_diff)))
levels(Match$goal_diff_class) <- c("home_loss","draw","home_win")
View(Match)
View(Match)
View(Match)
View(Match)
nb_match_team_season_2<- Match %>% group_by(home_team_api_id,season,goal_diff_class) %>% count()
nb_match_team_season_2<- Match %>% group_by(home_team_api_id,season,goal_diff_class) %>% count()
library(dplyr)
nb_match_team_season_2<- Match %>% group_by(home_team_api_id,season,goal_diff_class) %>% count()
View(nb_match_team_season_2)
View(Match)
test<-filter(Match, home_team_api_id==1601)
View(test)
View(test)
View(nb_match_team_season_2)
View(nb_match_team_season_2)
View(Team_home_viz)
View(Team_home_viz)
Team_home_viz_2<-cast(nb_match_team_season_2,home_team_api_id~season~goal_diff_class,fill=0)
Team_home_viz_2<-cast(nb_match_team_season_2,home_team_api_id~season~goal_diff_class,fill=0)
library(reshape2)
library(reshape)
Team_home_viz_2<-cast(nb_match_team_season_2,home_team_api_id~season~goal_diff_class,fill=0)
Team_home_viz_2<-cast(nb_match_team_season_2,home_team_api_id~season+goal_diff_class,fill=0)
View(Team_home_viz_2)
View(Team_home_viz_2)
View(Team_home_viz_2)
View(Team_home_viz_2)
View(nb_match_team_season_2)
View(nb_match_team_season_2)
colnames(Team_home_viz_2)
table(Team_home_viz_2$2015/2016_NA)
table(Team_home_viz_2$'2015/2016_NA')
View(Team_home_viz_2)
View(Team_home_viz_2)
colnames(Team_home_viz_2)[2:26]<-paste("nb_match", colnames(Team_home_viz_2[2:26]), sep = "_")
View(Team_home_viz_2)
View(Team_home_viz_2)
nb_match_team_season_3<- Match %>% group_by(home_team_api_id,season) %>% summarize(goal_scored=sum(home_team_goal))
View(nb_match_team_season_3)
View(nb_match_team_season_3)
View(test)
View(test)
View(test)
View(test)
test<-filter(Match, home_team_api_id==1601)
View(test)
View(test)
View(test)
View(test)
nb_match_team_season_3<- Match %>% group_by(home_team_api_id,season) %>% summarize(goal_scored=sum(home_team_goal), goal_conceded=sum(away_team_goal))
View(nb_match_team_season_3)
View(nb_match_team_season_3)
View(test)
View(test)
Team_home_viz_3<-cast(nb_match_team_season_3,home_team_api_id~season,fill=0)
View(test2)
View(test2)
View(Team_home_viz_3)
View(Team_home_viz_3)
nb_match_team_season_32<- melt(nb_match_team_season_3,  id=c("home_team_api_id", "season"))
nb_match_team_season_32<- melt(nb_match_team_season_3,id=c("home_team_api_id","season"), measured=c("goal_scored","goal_conceded"))
nb_match_team_season_32<- melt(nb_match_team_season_3,id=c("home_team_api_id","season"), measured=c("goal_scored","goal_conceded"))
library(reshape)
install.packages("reshape")
library(dplyr)
library(reshape2)
library(reshape)
nb_match_team_season_32<- melt(nb_match_team_season_3,id=c("home_team_api_id","season"), measured=c("goal_scored","goal_conceded"))
Team_home_viz_3<-cast(nb_match_team_season_3,home_team_api_id~season,fill=0)
Team_home_viz_31<-cast(nb_match_team_season_3,home_team_api_id~season,value=goal_scored,fill=0)
Team_home_viz_31<-cast(nb_match_team_season_3,home_team_api_id~season,value="goal_scored",fill=0)
View(Team_home_viz_31)
View(Team_home_viz_31)
View(nb_match_team_season_3)
View(nb_match_team_season_3)
View(Team_home_viz_31)
View(Team_home_viz_31)
colnames(Team_home_viz_31)[2:9]<-paste("nb_goal_scored", colnames(Team_home_viz_31[2:9]), sep = "_")
View(Team_home_viz_31)
View(Team_home_viz_31)
Team_home_viz_32<-cast(nb_match_team_season_3,home_team_api_id~season,value="goal_conceded",fill=0)
colnames(Team_home_viz_32)[2:9]<-paste("nb_goal_conceded", colnames(Team_home_viz_32[2:9]), sep = "_")
View(Team_home_viz_32)
View(Team_home_viz_32)
View(nb_match_team_season_3)
View(nb_match_team_season_3)
View(Team_home_viz)
View(Team_home_viz)
View(Team_home_viz_3)
View(Team_home_viz_3)
Team_home_viz <- Team_home_viz %>% inner join (Team_home_viz_2) %>% inner join (Team_home_viz_31)
%>% inner join (Team_home_viz_32)
test<- Team_home_viz %>% inner_join (Team_home_viz_2) %>% inner_join (Team_home_viz_31) %>% inner_join (Team_home_viz_32)
library(ggplot2)
View(Match_viz)
View(Match_viz)
View(Match_viz)
View(Match_viz)
list_home_team_viz=Match_viz[,"home_team_api_id"]
list_home_team_viz<-unique(Match_viz$home_team_api_id)
test <-list_home_team_viz %>% inner_join(Team_home_viz)
test <-as.data.frame(list_home_team_viz) %>% inner_join(Team_home_viz)
t<-as.data.frame(list_home_team_viz)
list_home_team_viz<-as.data.frame(unique(Match_viz$home_team_api_id))
View(t)
View(t)
View(list_home_team_viz)
View(list_home_team_viz)
names(list_home_team_viz)
colnames(list_home_team_viz) <- "home_team_api_id"
names(list_home_team_viz)
test <-ist_home_team_viz %>% inner_join(Team_home_viz)
test <-list_home_team_viz %>% inner_join(Team_home_viz)
nb_match_team_season<- Match %>% group_by(home_team_api_id,season) %>% count()
Team_home_viz<-cast(nb_match_team_season,home_team_api_id~season,fill=0)
colnames(Team_home_viz)[2:9]<-paste("nb_match", colnames(Team_home_viz[2:9]), sep = "_")
nb_match_team_season_2<- Match %>% group_by(home_team_api_id,season,goal_diff_class) %>% count()
Team_home_viz_2<-cast(nb_match_team_season_2,home_team_api_id~season+goal_diff_class,fill=0)
#colnames(Team_home_viz_2)
#table(Team_home_viz_2$'2015/2016_NA')
colnames(Team_home_viz_2)[2:26]<-paste("nb_match", colnames(Team_home_viz_2[2:26]), sep = "_")
## nb de buts marqués et encaissés
nb_match_team_season_3<- Match %>% group_by(home_team_api_id,season) %>% summarize(goal_scored=sum(home_team_goal), goal_conceded=sum(away_team_goal))
Team_home_viz_31<-cast(nb_match_team_season_3,home_team_api_id~season,value="goal_scored",fill=0)
colnames(Team_home_viz_31)[2:9]<-paste("nb_goal_scored", colnames(Team_home_viz_31[2:9]), sep = "_")
Team_home_viz_32<-cast(nb_match_team_season_3,home_team_api_id~season,value="goal_conceded",fill=0)
colnames(Team_home_viz_32)[2:9]<-paste("nb_goal_conceded", colnames(Team_home_viz_32[2:9]), sep = "_")
tt<-list_home_team_viz %>% inner_join(Team_home_viz)%>% inner_join (Team_home_viz_2) %>% inner_join (Team_home_viz_31)%>% inner_join (Team_home_viz_32)
Team_home_viz<-tt
View(Team_Attributes)
View(Team_Attributes)
temp <- list_home_team_viz %>% inner_join(Team_attributes,by= c("home_team_api_id"="team_api_id"))
temp <- list_home_team_viz %>% inner_join(Team_Attributes,by= c("home_team_api_id"="team_api_id"))
table(temp$date)
temp$annee<-substr(temp$date,1,4)
View(temp)
View(temp)
View(temp)
View(temp)
View(Team)
View(Team)
table(temp$annee)
View(temp)
View(temp)
colnames(temp)
test <- temp  %>% group_by(team_api_id,annee)  %>% n_distinct(buildUpPlaySpeedClass)
test <- temp  %>% group_by(home_team_api_id,annee)  %>% n_distinct(buildUpPlaySpeedClass)
test <- temp  %>% group_by(home_team_api_id,annee)
View(test)
View(test)
